{% macro render_custom_model_form(study, custom_model=None) %}
  {% if custom_model: %}
    <div class="preview js-preview">
      <button class="white-button small-button small float-right js-edit-model">
        üìù Edit
      </button>

      <h3>Model: {{ custom_model.name }}</h3>

      {% if custom_model.url: %}
        <p>{{ custom_model.url|external_link }}</p>
      {% endif %}

      {% if custom_model.description: %}
        <p class="small">
          {{ custom_model.description }}
        </p>
      {% endif %}
    </div>
  {% endif %}

  <form
      data-custom-model-id="{{ custom_model.id or "new" }}"
      action="{{ url_for('modeling_custom_model_update_action', publicId=study.publicId) }}"
      method="POST"
      class="simple-form hidden">
    <h3>Describe custom model</h3>

    <input type="hidden" name="customModelId" value="{{ custom_model.id or "new" }}" />
    <input type="hidden" name="selectedMeasurementContextId" />

    <div class="form-row columns">
      <div class="column flex-1">
        <label class="full">
          <span class="required">Model name</span>
          <input
              required
              name="name"
              type="text"
              value="{{ custom_model.name or '' }}"
              class="form-input-blue form-input-full"
              placeholder="Pick a short label for the model" />
        </label>

        <label
            class="full"
            data-tooltip="Where can people find more information about the modeling process?">
          <span>Information URL</span>
          <input
              name="url"
              type="url"
              value="{{ custom_model.url or '' }}"
              class="form-input-blue form-input-full"
              placeholder="https://example.com" />
        </label>
      </div>

      <div class="column flex-2">
        <label class="full">
          <span>Description</span>
          <textarea
              rows=3
              name="description"
              class="form-input-blue form-input-full"
              placeholder="Provide a short description of your modeling methodology">
            {{- custom_model.description or '' -}}
          </textarea>
        </label>
      </div>
    </div>

    <input
        type="submit"
        value="{{ 'Update' if custom_model else 'Create' }}"
        class="flex-end" />
  </form>

{% endmacro %}
